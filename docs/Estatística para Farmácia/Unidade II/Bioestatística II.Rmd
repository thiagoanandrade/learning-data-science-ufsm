---
title: "Estat√≠stica para Farm√°cia <br/> Unidade II <br/> Introdu√ß√£o √† Probabilidade"
author: "Prof. Thiago A. N. De Andrade"
institute: "Universidade Federal de Santa Maria <br/> Departamento de Estat√≠stica"
date: "`r Sys.Date()`"

output:
  xaringan::moon_reader:
    css: xaringan-themer.css
    nature:
      ratio: '16:9'
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: true
  github_document:
    html_preview: false

header-includes:
- \usepackage{tikz}
- \usepackage{geometry}
- \usepackage{amsfonts}
- \usepackage{smartdiagram}
- \usepackage{metalogo}
- \usepackage{fancybox}
- \usepackage{wasysym}
- \usepackage{mathpazo}
---
```{r setup, include=FALSE, warning=FALSE, message=FALSE}
options(htmltools.dir.version = FALSE)

knitr::opts_chunk$set(echo=F,
                      message=F,
                      warning=F,
                      fig.align = 'center', 
                      dpi=200, 
                      fig.width=9, 
                      fig.height=4)

library(xaringanthemer)

style_mono_accent(
  base_color = "tomato4",
 header_font_google = google_font("Josefin Sans"),
 text_font_google   = google_font("Montserrat"),
  code_font_google   = google_font("Fira Mono")
)

style_mono_light(base_color = "tomato4",
                 base_font_size = "28px")

library(tidyverse)


```




###  Aviso aos estudantes

```{css, echo=FALSE}

body {
  text-align: justify;
}

```


```{css, echo=FALSE}
.centered {
  display: block;
  margin-left: auto;
  margin-right: auto;
}
```


> - Este √© um material novo e atualizado, elaborado especialmente para nosso curso **Estat√≠stica para Farm√°cia - UFSM 2024.2**. Entretanto, **n√£o se configura em conte√∫do original**. √â apenas uma compila√ß√£o resumida de conte√∫dos presentes nas refer√™ncias citadas. Em resumo: √© indispens√°vel consultar as refer√™ncias indicadas.

> - As imagens n√£o s√£o autorais e os respectivos cr√©ditos s√£o reservados aos autores.


> - Este material foi integralmente produzido em  `R Markdown`, utilizando o pacote `xaringan`, que possibilita a cria√ß√£o de apresenta√ß√µes **ninja**.

---

class: middle

# Introdu√ß√£o √† Probabilidade

---
class: middle

### 1.Abordagem Subjetiva üé≤

A probabilidade subjetiva √© uma medida baseada na experi√™ncia ou opini√£o pessoal. Por exemplo, um farmac√™utico pode avaliar, com base em sua experi√™ncia, que h√° uma alta probabilidade (70%) de um paciente idoso n√£o aderir corretamente a um regime de m√∫ltiplos medicamentos, levando em conta fatores como complexidade do regime, hist√≥rico de esquecimentos e instru√ß√µes fornecidas.

---

class: middle

### 2.Abordagem Frequentista üé≤üé≤

Na abordagem frequentista, a probabilidade √© determinada pela frequ√™ncia de ocorr√™ncia de um evento em um grande n√∫mero de tentativas. Por exemplo, se um estudo cl√≠nico mostrou que, em 1000 pacientes que tomaram um determinado medicamento, 300 desenvolveram um efeito colateral espec√≠fico, ent√£o a probabilidade de um novo paciente desenvolver o mesmo efeito colateral seria calculada como $P = \frac{300}{1000} = 0.3$ ou 30%.

---
class: middle

###  3.Abordagem Cl√°ssica üé≤üé≤üé≤

Na abordagem cl√°ssica, a probabilidade √© calculada assumindo que todos os eventos poss√≠veis s√£o igualmente prov√°veis. Por exemplo, ao analisar o risco de um determinado polimorfismo gen√©tico afetar a metaboliza√ß√£o de um medicamento, se existem 3 alelos poss√≠veis e um √© conhecido por causar a metaboliza√ß√£o lenta, a probabilidade cl√°ssica de encontrar um paciente com esse alelo espec√≠fico em uma popula√ß√£o aleat√≥ria seria de $\frac{1}{3}$ (assumindo que todos s√£o igualmente comuns).

---
class: middle


### 4.Abordagem de Kolmogorov üé≤üé≤üé≤üé≤

Na abordagem axiom√°tica de Kolmogorov, a probabilidade √© definida por um conjunto de axiomas matem√°ticos. Por exemplo, para o c√°lculo de risco de intera√ß√£o medicamentosa entre dois f√°rmacos A e B, onde as probabilidades s√£o independentes, podemos definir que a probabilidade de ambos ocorrerem simultaneamente √© dada por $P(A \cap B) = P(A) \cdot P(B)$. Essa abordagem permite lidar com probabilidades complexas de forma rigorosa.

---
class: middle

### Aten√ß√£o ‚ÄºÔ∏èüêç

Probabilidade √© SEMPRE positiva, e definida no intervalo [0,1]. N√£o obstante, √© comum express√°-la em porcentagens.

---
class: middle

A **probabilidade** √© sempre **positiva** e est√° **definida no intervalo [0,1]**. Isso significa que a probabilidade de um evento nunca pode ser menor que zero nem maior que um. Na pr√°tica:

--
- **0** representa a impossibilidade absoluta do evento ocorrer.
- **1** representa a certeza absoluta de que o evento ocorrer√°.


--
Matematicamente, para qualquer evento $A$:

$$ 0 \leq P(A) \leq 1 $$
--


A convers√£o para porcentagem ajuda a comunicar de forma mais intuitiva, especialmente em √°reas como Farm√°cia, onde √© comum discutir riscos, efic√°cia e taxas de ocorr√™ncia em termos percentuais.

---

class: middle

### Aten√ß√£o ‚ÄºÔ∏èüêç

S√≥ faz sentido calcularmos probabilidades quando estamos diante de **fen√¥menos aleat√≥rios**, ou seja, fen√¥menos onde o resultado √© incerto:

- **Podem ser repetidos**: O fen√¥meno deve ser repet√≠vel, nas mesmas condi√ß√µes, para que possamos observar a variabilidade de seus resultados.

- **Conhecemos o conjunto de resultados poss√≠veis**: Mesmo sem prever um resultado espec√≠fico, sabemos quais s√£o todos os resultados poss√≠veis (espa√ßo amostral).

- **Lei dos Grandes N√∫meros**: √Ä medida que repetimos o experimento um grande n√∫mero de vezes, a frequ√™ncia relativa de um evento tende a se aproximar de sua probabilidade te√≥rica.

---
class: middle



```{r, fig.align='center', out.width='30%'}
knitr::include_graphics("download.jfif")
``` 

[Cena do filme 21 Quebrando a Banca](https://www.youtube.com/watch?v=fwoq2ZzLuQo)
---
class: middle

#### Exemplo:  Experimento de Monty Hall 
--

Imagine que voc√™ est√° em um jogo de TV com **tr√™s portas**:üö™üö™üö™
--

- **Uma porta tem um carro** como pr√™mio. üöò
- **Duas portas t√™m bodes**. üêêüêê
--

#### Regras:
--

1. Voc√™ escolhe uma porta.
--

2. O apresentador, que **sabe onde est√° o carro**, **abre uma das outras duas portas**, revelando um bode.
--

3. Ele lhe oferece a chance de **trocar de porta**.
--

#### Pergunta: **Voc√™ deveria manter sua escolha inicial ou trocar para a outra porta?** Qual estrat√©gia oferece uma maior chance de ganhar o carro?

---

class: middle

#### Experimento de Monty Hall: A Resposta

#### An√°lise:

1. **Probabilidade Inicial**:
   - Escolha inicial de uma porta: $\frac{1}{3}$ chance de ter o carro.
   - Outras duas portas: $\frac{2}{3}$ chance de ter o carro.

2. **O Apresentador Abre uma Porta com um Bode**:
   - A probabilidade de sua porta original ter o carro **permanece $\frac{1}{3}$**.
   - A probabilidade de o carro estar nas outras portas **se concentra na √∫nica porta restante: $\frac{2}{3}$**.
   
---

class: middle

#### Conclus√£o:

**Trocar de porta dobra suas chances de ganhar!** 

- Manter a escolha inicial: $\frac{1}{3}$.
- Trocar de porta: $\frac{2}{3}$.





---
class: middle

# Distribui√ß√£o Normal

---

class: middle

#### O que √© a Distribui√ß√£o Normal?

A distribui√ß√£o normal, tamb√©m conhecida como distribui√ß√£o de Gauss, √© uma distribui√ß√£o de probabilidade cont√≠nua que √© sim√©trica em torno da m√©dia. Ela √© caracterizada pela famosa curva em forma de sino.

---
class: middle

#### Caracter√≠sticas da Distribui√ß√£o Normal:

- **Simetria**: A curva √© sim√©trica em rela√ß√£o √† m√©dia.

- **M√©dia, Mediana e Moda**: Na distribui√ß√£o normal, a m√©dia, mediana e moda s√£o iguais.

- **Forma**: A forma da distribui√ß√£o √© determinada pelos par√¢metros de m√©dia $\mu$ e desvio padr√£o $\sigma$.

---

class: middle

#### Fun√ß√£o Densidade de Probabilidade

A fun√ß√£o densidade de probabilidade (PDF) da distribui√ß√£o normal √© dada por:


$$f(x) = \frac{1}{\sigma \sqrt{2\pi}} e^{-\frac{(x - \mu)^2}{2\sigma^2}} $$

em que:

- $\mu$ = m√©dia da distribui√ß√£o

- $\sigma$ = desvio padr√£o da distribui√ß√£o

---
class: middle

#### A Curva Normal

![Curva Normal](https://upload.wikimedia.org/wikipedia/commons/thumb/8/8c/Standard_deviation_diagram.svg/800px-Standard_deviation_diagram.svg.png)

---

class: middle

#### Propriedades:

- **68-95-99.7 Regra**: Aproximadamente 68% dos dados est√£o dentro de um desvio padr√£o da m√©dia, 95% dentro de dois desvios padr√£o e 99.7% dentro de tr√™s desvios padr√£o.

- **√Årea sob a curva**: A √°rea total sob a curva √© igual a 1, representando 100% da probabilidade.

---
class: middle

#### Aplica√ß√µes da Distribui√ß√£o Normal em Farm√°cia

1.**Controle de Qualidade**: A an√°lise da variabilidade no peso dos comprimidos produzidos em uma f√°brica de medicamentos pode ser modelada por uma distribui√ß√£o normal. Por exemplo, um lote de comprimidos de 500 mg pode ter um desvio padr√£o de 5 mg. A distribui√ß√£o normal ajuda a garantir que a maioria dos comprimidos est√° dentro de uma faixa aceit√°vel.

---
class: middle

2.**Farmacocin√©tica**: Em estudos de farmacocin√©tica, a distribui√ß√£o das concentra√ß√µes de um f√°rmaco no plasma sangu√≠neo em uma popula√ß√£o √© frequentemente modelada como uma distribui√ß√£o normal. Isso √© √∫til para prever como a maioria dos pacientes absorve e elimina o medicamento.

---
class: middle

3.**Estudos Cl√≠nicos**: Ao analisar os resultados de ensaios cl√≠nicos, a variabilidade nas respostas dos pacientes ao tratamento pode ser modelada por uma distribui√ß√£o normal. Por exemplo, o tempo m√©dio de resposta a um analg√©sico, com um desvio padr√£o espec√≠fico, permite prever como diferentes pacientes podem reagir.

---
class: middle

4.**Determina√ß√£o de Doses**: Em farmacologia, a resposta de uma popula√ß√£o a uma determinada dose de um medicamento √© muitas vezes distribu√≠da normalmente. Atrav√©s da distribui√ß√£o normal, √© poss√≠vel calcular a dose mais eficaz para a maioria dos pacientes, minimizando efeitos adversos.


---
class: middle

5.**Estabilidade de Medicamentos**: Estudos de estabilidade s√£o realizados para entender como um medicamento se degrada ao longo do tempo. A distribui√ß√£o normal pode ser usada para modelar a variabilidade dos resultados desses testes, ajudando a prever o prazo de validade.


---
class: middle

6.**Par√¢metros Fisiol√≥gicos**: Par√¢metros fisiol√≥gicos importantes, como a press√£o arterial, n√≠veis de glicose e frequ√™ncia card√≠aca, tendem a seguir uma distribui√ß√£o normal em uma popula√ß√£o saud√°vel. Isso permite que farmac√™uticos identifiquem padr√µes e desenvolvam medicamentos para ajustes em casos de desvio da normalidade.


---
class: middle

#### Distribui√ß√£o Normal Padronizada (Z-Score)

#### Defini√ß√£o:

A distribui√ß√£o normal padronizada tem m√©dia 0 e desvio padr√£o 1. Qualquer distribui√ß√£o normal pode ser transformada em uma distribui√ß√£o normal padr√£o atrav√©s da f√≥rmula do Z-score:

$$Z = \frac{X - \mu}{\sigma}$$
---
class: middle

#### Interpreta√ß√£o:

- O Z-score representa o n√∫mero de desvios padr√£o que um dado ponto est√° afastado da m√©dia.

- Ser√° muito importante para o c√°lculo do tamanho amostral conforme veremos a seguir.

---
class: middle

## Tabelas de Distribui√ß√£o Normal

| Margem de Erro (%) | N√≠vel de Confian√ßa (%) | Valor Z  |
|--------------------|------------------------|----------|
| 1%                 | 99%                    | 2.58    |
| 5%                 | 95%                    | 1.96    |
| 10%                | 90%                    | 1.64    |


---
class: middle

```{r, echo=FALSE }
# Carregar pacotes necess√°rios
library(ggplot2)

# Gerar dados simulados de pesos de comprimidos a partir de uma distribui√ß√£o normal
set.seed(123)  # Para reprodutibilidade
peso_comprimidos <- rnorm(1000, mean = 500, sd = 20)  # 1000 comprimidos, m√©dia de 500 mg, desvio padr√£o de 20 mg

# Criar histograma dos pesos dos comprimidos
ggplot(data.frame(peso_comprimidos), aes(x = peso_comprimidos)) +
  geom_histogram(aes(y = ..density..), binwidth = 5, color = "black", fill = "darkseagreen4") +
  stat_function(fun = dnorm, args = list(mean = mean(peso_comprimidos), sd = sd(peso_comprimidos)), 
                color = "blue", size = 1) +
  labs(title = " Exemplo: Histograma dos Pesos dos Comprimidos",
       x = "Peso dos Comprimidos (mg)",
       y = "Densidade") +
  theme_minimal()
```
---
class: middle

# Teorema Central do Limite (TCL)

---
class: middle

#### Teorema Central do Limite (TCL) na Farm√°cia

O **Teorema Central do Limite (TCL)** nos diz que, para uma amostra suficientemente grande, a **distribui√ß√£o das m√©dias amostrais** se aproxima de uma **distribui√ß√£o normal**, independentemente da distribui√ß√£o original dos dados.

#### Import√¢ncia:

1. **Estudos de efic√°cia de medicamentos**: Permite calcular m√©dias e intervalos de confian√ßa para a resposta ao medicamento.
2. **Controle de Qualidade**: Avalia√ß√£o do peso m√©dio de comprimidos em lotes.
3. **Bioequival√™ncia**: Compara√ß√£o entre dois medicamentos.

---

class: middle

#### Exemplo Pr√°tico: Controle de Qualidade

Em uma f√°brica de medicamentos, a **distribui√ß√£o do peso de comprimidos individuais** pode n√£o ser exatamente normal, mas se tirarmos **amostras de tamanho grande** de cada lote e calcularmos a m√©dia dessas amostras, a **distribui√ß√£o das m√©dias amostrais** ser√° aproximadamente **normal**.

#### Aplica√ß√£o:

1. **Objetivo**: Garantir que o peso m√©dio dos comprimidos de um lote √© de 500 mg.
2. **Amostragem**: Seleciona-se amostras de 30 comprimidos por vez e calcula-se a m√©dia.
3. **TCL**: Com base no TCL, sabemos que as m√©dias amostrais seguem uma distribui√ß√£o normal, o que permite aplicar testes estat√≠sticos para verificar se o lote est√° dentro do padr√£o.

---
class: middle

#### Detalhando o Conceito do TCL

O ponto-chave do TCL √© que, quando repetimos o processo de amostragem v√°rias vezes e calculamos a m√©dia de cada amostra:

- A **m√©dia dessas m√©dias amostrais** ser√° **igual √† m√©dia da popula√ß√£o** original.
- O **desvio padr√£o das m√©dias** (chamado **erro padr√£o**) √© proporcional ao **desvio padr√£o da popula√ß√£o dividido pela raiz quadrada do tamanho da amostra**.

---
class: middle

Isso √© √∫til para a farm√°cia, pois mesmo que as caracter√≠sticas individuais (como peso dos comprimidos ou concentra√ß√£o de princ√≠pios ativos) possam n√£o seguir uma distribui√ß√£o normal, o TCL garante que **as m√©dias** de amostras grandes **seguir√£o uma distribui√ß√£o normal**, permitindo an√°lises robustas.
---
class: middle

#### Aplica√ß√£o Farmac√™utica do TCL

1. **Farmacocin√©tica**: A concentra√ß√£o de um f√°rmaco no plasma sangu√≠neo de uma amostra de pacientes pode ter uma distribui√ß√£o assim√©trica. Com base em amostras grandes, o TCL nos permite calcular uma m√©dia confi√°vel e intervalos de confian√ßa para prever a resposta esperada da popula√ß√£o.
---
class: middle

2. **Bioequival√™ncia**: Ao comparar dois medicamentos, o TCL √© aplicado para calcular m√©dias amostrais de medidas como a **√°rea sob a curva (AUC)** ou o **tempo de meia-vida**. Mesmo que os dados brutos n√£o sejam normais, o TCL assegura que as m√©dias amostrais sigam uma distribui√ß√£o normal, permitindo o uso de testes estat√≠sticos padr√£o.

---
class: middle

#### Em Conclus√£o:

O **TCL permite aos farmac√™uticos** e pesquisadores tomarem decis√µes baseadas em m√©dias e propor√ß√µes de amostras, com maior precis√£o e confian√ßa, facilitando an√°lises em contextos variados como controle de qualidade, ensaios cl√≠nicos e estudos de bioequival√™ncia.


---
class: middle

### Refer√™ncias



- [**Conceitos e an√°lises estat√≠sticas com R e JASP**](https://bookdown.org/luisfca/docs/)

- [**Regression Modelling for Biostatistics**](https://bookdown.org/stephane_heritier/RM1TEST/)


- [**Amostragem: Teoria e pr√°tica usando o `R`**](https://amostragemcomr.github.io/livro/index.html)

- [** `R` para Cientistas Sociais **](http://www.uesc.br/editora/livrosdigitais_20140513/r_cientistas.pdf)


---

class:  center, middle

N√£o deixe de entrar em contato comigo para tirar suas d√∫vidas: <thiagoan.andrade@gmail.com>


# Obrigado!

# Thanks!